# Лабораторная работа №4. Проектирование сети

**Описание/Пошаговая инструкция выполнения домашнего задания**:

    В этой самостоятельной работе мы ожидаем, что вы самостоятельно:

    - Разработаете и задокументируете адресное пространство для лабораторного стенда.
    - Настроите ip адреса на каждом активном порту.
    - Настроите каждый VPC в каждом офисе в своем VLAN.
    - Настроите VLAN/Loopbackup interface управления для сетевых устройств.
    - Настроите сети офисов так, чтобы не возникало broadcast штормов, а использование линков было максимально оптимизировано.
    - Используете IPv4. IPv6 по желанию.

**Топология**
![topology](./images/topology.png)

## Шаг 1: Продумывание адресного пространства

- [Адреса Loopback-интерфейсов наших маршрутизаторов](#адреса-loopback-интерфейсов-наших-маршрутизаторов)
- [Адреса SVI-интерфейсов коммутаторов](#адреса-svi-интерфейсов-коммутаторов)
- [Адреса офисных машин](#адреса-офисных-машин)
- [Адреса физических интерфейсов маршрутизаторов](#адреса-физических-интерфейсов-маршрутизаторов)
  - [Наши офисы](#наши-офисы)
  - [Оборудование провайдеров](#оборудование-провайдеров)
- [Адреса виртуальных маршрутизаторов "первого хопа"](#адреса-виртуальных-маршрутизаторов-первого-хопа)
- [Адреса ВСЕХ интерфейсов ВСЕХ устройств в одной большой таблице](#адреса-всех-интерфейсов-всех-устройств-в-одной-большой-таблице)

Сложно заглянуть далеко в будущее, чтобы быть уверенным, что ничего из однажды заданного менять не придется, но на данном этапе видится, что адреса из публичных сетей будут присвоены только маршрутизаторам на границах наших офисов, все устройства внутри (за исключением, быть может, серверов, если какие-то из VPC их символизируют) будут иметь только приватные адреса, причем желательно, чтобы на Loopback-интерфейсах маршрутизаторов, на SVI-интерфейсах коммутаторов и интерфейсах офисных компьютеров были адреса из одного префикса (например, `192.168.0.0/16`), а на физических интерфейсах маршрутизаторов - из других, причем гораздо более мелко нарезанных (например, `10.X.Y.Z/30`, вся такая сеть - соединение двух маршрутизаторов).

Маршрутизаторы из групп Киторн, Ламас и Триада считаем оборудованием провайдеров, т.е. про наши приватные сети из префиксов `192.168.0.0/16` и `10.0.0.0/8` они знать ничего не будут.

Для доступа на устройства, мы будем использовать адреса, присвоенные Loopback-интерфейсам, чтобы не думать, по какому пути, через какие физические интерфейсы, будет идти трафик от "нас" (откуда мы пытаемся обратиться к устройству). Эти же адреса впоследствии будем добавлять в протоколы динамической маршрутизации.

Также хочется разделить префиксы по географическому признаку, пусть, например, адреса на Loopback-интефейсах в московском офисе будут выделены из префикса `192.168.77.0/24`, а в питерском - из `192.168.78.0/24` (т.е. максимум по `2 ^ 8 - 2 = 254` устройства на офис/регион). Для однозначного определения расположения устройства по адресу его Loopback/SVI интерфейса, в третьем октете адреса будем использовать те же числа, что и автомобильные коды регионов. Изначально хотели использовать числа, начиная с единицы, но позже решили, что для SVI-интерфейсов коммутаторов было бы удобно обозначить в самом адресе номер management VLAN-а, а иметь VLAN c номером 1 небезопасно.

На граничных маршрутизаторах офисов, очевидно, будет осуществляться трансляция в публичные адреса и будут подняты VPN-туннели, чтобы из любого офиса можно было сходить в любой другой по адресам из `192.168.0.0/16`.

Пусть также для удобства число в четвертом октете адреса Loopback-интерфейса будет соответствовать номеру устройства, например, для московского `R15` адресом на `Lo0` будет `192.168.77.15/32`, для питерского `R32` - `192.168.78.32/32`. К счастью для нас, в исходной топологии номера устройств уникальны для всех наших локаций (т.е. если устройство с номером N есть в офисе в Санкт-Петербурге, то устройства с таким же номером N не может быть в Москве).

В случае с физическими адресами, будем придерживаться следующего "правила":

Для интерфейсов, смотрящих в сторону устройств, находящихся относительно данного "снизу" в нашей топологии, во втором октете будем записывать номер самого устройства, а в третьем октете будем записывать номер устройства "снизу", с которым соединен этот интерфейс. В четвертом октете будет первый доступный адрес из префикса `/30`. Например, интерфейс `e0/0` маршрутизатора `R15` соединен с маршрутизатором `R13`, поэтому его адрес будет иметь вид `10.15.13.1/30`.

Соответственно, для интерфейсов, смотрящих в сторону устройств, находящихся относительно данного "сверху" в нашей топологии, во втором октете будет записан номер устройства "сверху", в третьем октете - номер самого устройства, а в четвертом - следующий адрес из префикса `/30`. Например, для интерфейса `e0/3` маршрутизатора `R12`, который соединен с `R15`, по нашему "правилу" получится адрес `10.15.12.2/30`.

![step1a](./images/step1a.png)

Такое "правило" нивелирует преимущество префиксов самого маленького размера, с тем же успехом можно было брать сети `/24`, и создает искусственное ограничение в 255 маршрутизаторов (максимально возможно значение во втором и третьем октете) на все офисы, но мы сделали выбор в пользу большей понятности, а не экономии приватных адресов.


### **Адреса Loopback-интерфейсов наших маршрутизаторов**:

Код региона в третьем октете.

#### ***Москва***:

| Устройство | Интерфейс | IP-адрес         |
| :--------- | :-------- | :--------------- |
| R12        | Loopback0 | 192.168.77.12/32 |
| R13        | Loopback0 | 192.168.77.13/32 |
| R14        | Loopback0 | 192.168.77.14/32 |
| R15        | Loopback0 | 192.168.77.15/32 |
| R19        | Loopback0 | 192.168.77.19/32 |
| R20        | Loopback0 | 192.168.77.20/32 |

#### ***Санкт-Петербург***:

| Устройство | Интерфейс | IP-адрес         |
| :--------- | :-------- | :----------------|
| R16        | Loopback0 | 192.168.78.16/32 |
| R17        | Loopback0 | 192.168.78.17/32 |
| R18        | Loopback0 | 192.168.78.18/32 |
| R32        | Loopback0 | 192.168.78.32/32 |

#### ***Лабытнанги***:

| Устройство | Интерфейс | IP-адрес         |
| :--------- | :-------- | :--------------- |
| R27        | Loopback0 | 192.168.89.27/32 |

#### ***Чокурдах***:

| Устройство | Интерфейс | IP-адрес         |
| :--------- | :-------- | :--------------- |
| R28        | Loopback0 | 192.168.14.28/32 |

### **Адреса SVI-интерфейсов коммутаторов**:

Код региона в третьем октете - он же соответствует номеру management VLAN-а. Длина префикса `/24` - хотели выставить `/32`, но Cisco IOS не позволяет это сделать.

#### ***Москва***:

| Устройство | Интерфейс | IP-адрес         |
| :--------- | :-------- | :--------------- |
| SW2        | SVI 77    | 192.168.77.12/24 |
| SW3        | SVI 77    | 192.168.77.13/24 |
| SW4        | SVI 77    | 192.168.77.14/24 |
| SW5        | SVI 77    | 192.168.77.15/24 |

#### ***Санкт-Петербург***:

| Устройство | Интерфейс | IP-адрес         |
| :--------- | :-------- | :--------------- |
| SW9        | SVI 78    | 192.168.78.9/24  |
| SW10       | SVI 78    | 192.168.78.10/24 |

#### ***Чокурдах***:

| Устройство | Интерфейс | IP-адрес         |
| :--------- | :-------- | :--------------- |
| SW29       | SVI 14    | 192.168.14.29/24 |

### **Адреса офисных машин**:

#### ***Москва***:

| Устройство | Интерфейс | IP-адрес        |
| :--------- | :-------- | :-------------- |
| VPC1       | eth0      | 192.168.77.1/24 |
| VPC7       | eth0      | 192.168.77.7/24 |

#### ***Санкт-Петербург***:

| Устройство | Интерфейс | IP-адрес         |
| :--------- | :-------- | :--------------- |
| VPC8       | eth0      | 192.168.78.8/24  |
| VPC11      | eth0      | 192.168.78.11/24 |

#### ***Чокурдах***:

| Устройство | Интерфейс | IP-адрес         |
| :--------- | :-------- | :--------------- |
| VPC30      | eth0      | 192.168.14.30/24 |
| VPC31      | eth0      | 192.168.14.31/24 |


### **Адреса физических интерфейсов маршрутизаторов**:

#### Наши офисы
Для адресов интерфейсов, соединенных с коммутаторами, в третьем октете будем дописывать к номеру коммутатора номер конечного устройства, находящегося в соотвествующем VLAN-е. В четвертом октете адресов таких интерфейсов всегда будем прописывать `254`. Чтобы номера VLAN-ов были выбраны не совсем случайно, а чтобы, находясь на коммутаторе, можно было понять, какому его интерфейсу какой VLAN должен соответствовать, будем использовать такую формулу: номер VPC умноженный на 10 - например, устройства `VPC30` и `VPC31`, соединенные с access-портами коммутатора `SW29` будут находиться в VLAN-ах 300 и 310 cоответственно (но в четвертом октете адресов sub-интерфейсов все-таки будем использовать не номер VLAN-а, а соотвествующий ему VPC, как раз из-за вылезающих за 255 номеров VLAN-ов). Конечно, для абстрактной сети это не очень удачная формула, но конкретно в нашем задании сказано "каждый VPC в каждом офисе в своем VLAN".


#### ***Москва***:

| Устройство | Интерфейс    | IP-адрес        |
| :--------- | :----------- | :-------------- |
| R12        | e0/2 (к R14) | 10.14.12.2/30   |
|            | e0/3 (к R15) | 10.15.12.2/30   |
|            | e0/0 (к SW4) |                 |
|            | e0/0.10      | 10.12.41.254/24 |
|            | e0/0.70      | 10.12.47.254/24 |
|            | e0/1 (к SW5) |                 |
|            | e0/1.10      | 10.12.51.254/24 |
|            | e0/1.70      | 10.12.57.254/24 |


| Устройство | Интерфейс    | IP-адрес         |
| :--------- | :----------- | :--------------- |
| R13        | e0/2 (к R15) | 10.15.13.2/30    |
|            | e0/3 (к R14) | 10.14.13.2/30    |
|            | e0/0 (к SW5) |                  |
|            | e0/0.10      | 10.13.51.254/24  |
|            | e0/0.70      | 10.13.57.254/24  |
|            | e0/1 (к SW4) |                  |
|            | e0/1.10      | 10.13.41.254/24  |
|            | e0/1.70      | 10.13.47.254/24  |

| Устройство | Интерфейс    | IP-адрес      |
| :--------- | :----------- | :------------ |
| R19        | e0/0 (к R14) | 10.14.19.2/30 |

| Устройство | Интерфейс    | IP-адрес      |
| :--------- | :----------- | :------------ |
| R20        | e0/0 (к R15) | 10.15.20.2/30 |

Для провайдеров Киторн и Ламас выберем случайные существующие сети:

Киторн-Москва `38.156.254.0/24`
Ламас-Москва `131.72.76.0/24`
Киторн-Ламас `161.18.208.0/24`

| Устройство | Интерфейс            | IP-адрес          |
| :--------- | :------------------- | :---------------- |
| R14        | e0/0 (к R12)         | 10.14.12.1/30     |
|            | e0/1 (к R13)         | 10.14.13.1/30     |
|            | e0/1 (к R22 Киторн)  | 38.156.254.14/24  |
|            | e0/3 (к R19)         | 10.14.19.1/30     |

| Устройство | Интерфейс           | IP-адрес         |
| :--------- | :------------------ | :--------------- |
| R15        | e0/0 (к R13)        | 10.15.13.1/30    |
|            | e0/1 (к R12)        | 10.15.12.1/30    |
|            | e0/2 (к R21 Ламас)  | 131.72.76.15/24  |
|            | e0/3 (к R20)        | 10.15.20.1/30    |

#### ***Санкт-Петербург***:

| Устройство | Интерфейс     | IP-адрес         |
| :--------- | :------------ | :--------------- |
| R16        | e0/1 (к R18)  | 10.18.16.2/30    |
|            | e0/3 (к R32)  | 10.16.32.1/30    |
|            | e0/0 (к SW10) |                  |
|            | e0/0.80       | 10.16.108.254/24 |
|            | e0/0.110      | 10.16.101.254/24 |
|            | e0/2 (к SW9)  |                  |
|            | e0/2.80       | 10.16.98.254/24  |
|            | e0/2.110      | 10.16.91.254/24  |


| Устройство | Интерфейс     | IP-адрес         |
| :--------- | :------------ | :--------------- |
| R17        | e0/1 (к R18)  | 10.18.17.2/30    |
|            | e0/0 (к SW9)  |                  |
|            | e0/0.80       | 10.17.98.254/24  |
|            | e0/0.110      | 10.17.91.254/24  |
|            | e0/2 (к SW10) |                  |
|            | e0/2.80       | 10.17.108.254/24 |
|            | e0/2.110      | 10.17.101.254/24 |

| Устройство | Интерфейс    | IP-адрес      |
| :--------- | :----------- | :------------ |
| R32        | e0/0 (к R16) | 10.16.32.2/30 |


Пусть все интерфейсы, соединенные с внешними интерфейсами маршрутизаторов Триады, будут иметь адреса из префикcов `89.178.XY.Z/24`, где `X` - номер "нашего" маршрутизатора, `Y` - номер интерфейса "нашего" маршрутизатора (если он подключен сразу к нескольким марщрутизаторам Триады), `Z`- номер маршрутизатора Триады.

| Устройство | Интерфейс           | IP-адрес         |
| :--------- | :------------------ | :--------------- |
| R18        | e0/0 (к R16)        | 10.18.16.1/30    |
|            | e0/1 (к R17)        | 10.18.17.1/30    |
|            | e0/2 (к R24 Триада) | 89.178.182.24/24 |
|            | e0/3 (к R26 Триада) | 89.178.183.26/24 |

![step1b](./images/step1b.png)

#### ***Лабытнанги***:

| Устройство | Интерфейс           | IP-адрес        |
| :--------- | :------------------ | :-------------- |
| R27        | e0/0 (к R25 Триада) | 89.178.27.25/24 |

#### ***Чокурдах***:

Здесь такой же трюк с `89.178.XY.Z/24` (см. выше) не провернуть, т.к. полученное `XY` окажется больше 255, поэтому будем добавлять цифру из номера интерфейса в середину, между двумя цифрами номера маршрутизатора (получится 208 и 218).

| Устройство | Интерфейс           | IP-адрес         |
| :--------- | :------------------ | :--------------- |
| R28        | e0/0 (к R26 Триада) | 89.178.208.26/24 |
|            | e0/1 (к R25 Триада) | 89.178.218.25/24 |

#### Оборудование провайдеров

Выше выбрали сеть `161.18.208.0/24` между провайдерами Киторн-Ламас. Для интерфейсов в сторону Триады правило то же: `89.178.X.Z/24`, где `X` - номер маршрутизатора Киторн/Ламас, `Z`- номер маршрутизатора Триады.

#### ***Ламас***:

| Устройство | Интерфейс           | IP-адрес         |
| :--------- | :------------------ | :--------------- |
| R21        | e0/0 (к R15)        | 131.72.76.1/24   |
|            | e0/1 (к R22 Киторн) | 161.18.208.21/24 |
|            | e0/2 (к R24 Триада) | 89.178.21.24/24  |

#### ***Киторн***:

| Устройство | Интерфейс           | IP-адрес         |
| :--------- | :------------------ | :--------------- |
| R22        | e0/0 (к R14)        | 38.156.254.1/24  |
|            | e0/1 (к R21 Ламас)  | 161.18.208.22/24 |
|            | e0/2 (к R23 Триада) | 89.178.22.23/24  |

#### ***Триада***:

Выберем `/24` сети для взаимодействия внутри Триады из приватного префикса `172.16.0.0/12`. Опять-таки, можно было обойтись сетями `\30`, но мы хотим, чтобы в четвертом октете адресов содержалось значение, имеющее какой-то смысл.
Пусть в третьем октете содержится число, составленное из младших разрядов номеров маршрутизаторов, начиная с меньшей цифры, например, сеть между `R23` и `R25` будет иметь в третьем октете `35`, а между `R24` и `R25` - `46`.
В четвертом октете пусть содержится номер маршрутизатора, с которым соединен данный интерфейс, например, для интерфейса `e0/1` маршрутизатора `R23`, которым он соединен с `R25`, в четвертом октете адреса будет число `25`.

Адреса к офисам выделены из `89.178.XY.Z/24`, где `XY` - номер офисного маршрутизатора, с добавленным к нему номером интерфейса офисного маршрутизатора (для случаев, когда один офисный маршрутизатор соединен с несколькими маршрутизаторами Триады, см. выше описание перед таблицами офисных маршрутизаторов), `Z` же пускай всегда будет равным `254`.

| Устройство | Интерфейс           | IP-адрес         |
| :--------- | :------------------ | :--------------- |
| R23        | e0/0 (к R22 Киторн) | 89.178.22.254/24 |
|            | e0/1 (к R25)        | 172.16.35.25/24  |
|            | e0/2 (к R24)        | 172.16.34.24/24  |

| Устройство | Интерфейс           | IP-адрес          |
| :--------- | :------------------ | :---------------- |
| R24        | e0/0 (к R21 Ламас)  | 89.178.21.254/24  |
|            | e0/1 (к R26)        | 172.16.46.26/24   |
|            | e0/2 (к R23)        | 172.16.34.23/24   |
|            | e0/3 (к R18 Питер)  | 89.178.182.254/24 |

| Устройство | Интерфейс               | IP-адрес          |
| :--------- | :---------------------- | :---------------- |
| R25        | e0/0 (к R23)            | 172.16.35.23/24   |
|            | e0/1 (к R27 Лабытнанги) | 89.178.27.254/24  |
|            | e0/2 (к R25)            | 172.16.56.26/24   |
|            | e0/3 (к R28 Чокурдах)   | 89.178.218.254/24 |

| Устройство | Интерфейс               | IP-адрес          |
| :--------- | :---------------------- | :---------------- |
| R26        | e0/0 (к R24)            | 172.16.46.24/24   |
|            | e0/1 (к R28 Чокурдах)   | 89.178.208.254/24 |
|            | e0/2 (к R25)            | 172.16.56.25/24   |
|            | e0/3 (к R18 Питер)      | 89.178.183.254/24 |

![step1c](./images/step1c.png)

### **Адреса виртуальных маршрутизаторов "первого хопа"**:

Поскольку в офисах Москвы и Санкт-Петербурга имеется по два VLAN-а, и по два маршрутизатора "первого хопа", напрашивается также добавление двух групп VRRP: для каждого VLAN-а будет свой адрес шлюза по умолчанию, оба из которых - вирутальные для пары маршрутизаторов, причем для одного VLAN-а более приоритетным будет один из физических маршрутизаторов пары, а для второго VLAN-а - другой. 

Выделяем эти виртуальные адреса из того же префикса, что и для адресов Loopback-интерфейсов маршрутизаторов и для адресов офисных машин.

Хотим использовать в четвертом октете номер VLAN-а, нам повезло, что нет пересечений с номерами устройств.

#### ***Москва***:

| Устройство | VLAN | IP-адрес         |
| :--------- | :--- | :--------------- |
| R12-R13    | 10   | 192.168.77.10/24 |
|            | 70   | 192.168.77.70/24 |

#### ***Санкт-Петербург***:

| Устройство | VLAN | IP-адрес          |
| :--------- | :--- | :---------------- |
| R16-R17    | 80   | 192.168.78.80/24  |
|            | 110  | 192.168.78.110/24 |

### **Адреса ВСЕХ интерфейсов ВСЕХ устройств в одной большой таблице**

| Устройство | Локация         | Интерфейс               | IP-адрес          |
| :--------- |:--------------  | :---------------------- | :---------------- |
| VPC1       | Москва          | eth0 (к SW3)            | 192.168.77.1/24   |
| SW2        | Москва          | SVI 77                  | 192.168.77.12/24  |
| SW3        | Москва          | SVI 77                  | 192.168.77.13/24  |
| SW4        | Москва          | SVI 77                  | 192.168.77.14/24  |
| SW5        | Москва          | SVI 77                  | 192.168.77.15/24  |
| VPC7       | Москва          | eth0 (к SW2)            | 192.168.77.7/24   |
| VPC8       | Санкт-Петербург | eth0 (к SW9)            | 192.168.78.8/24   |
| SW9        | Санкт-Петербург | SVI 78                  | 192.168.78.9/24   |
| SW10       | Санкт-Петербург | SVI 78                  | 192.168.78.10/24  |
| VPC11      | Санкт-Петербург | eth0 (к SW10)           | 192.168.78.11/24  |
| R12        | Москва          | e0/0 (к SW4)            |                   |
|            |                 | e0/0.10 (VLAN 10)       | 10.12.41.254/24   |
|            |                 | e0/0.70 (VLAN 70)       | 10.12.47.254/24   |
|            |                 | e0/1 (к SW5)            |                   |
|            |                 | e0/1.10 (VLAN 10)       | 10.12.51.254/24   |
|            |                 | e0/1.70 (VLAN 70)       | 10.12.57.254/24   |
|            |                 | e0/2 (к R14)            | 10.14.12.2/30     |
|            |                 | e0/3 (к R15)            | 10.15.12.2/30     |
|            |                 | Loopback0               | 192.168.77.12/32  |
| R13        | Москва          | e0/0 (к SW5)            |                   |
|            |                 | e0/0.10                 | 10.13.51.254/24   |
|            |                 | e0/0.70                 | 10.13.57.254/24   |
|            |                 | e0/1 (к SW4)            |                   |
|            |                 | e0/1.10                 | 10.13.41.254/24   |
|            |                 | e0/1.70                 | 10.13.47.254/24   |
|            |                 | e0/2 (к R15)            | 10.15.13.2/30     |
|            |                 | e0/3 (к R14)            | 10.14.13.2/30     |
|            |                 | Loopback0               | 192.168.77.13/32  |
| R12-R13    | Москва          | VLAN10                  | 192.168.77.10/24  |
|            |                 | VLAN70                  | 192.168.77.70/24  |
| R14        | Москва          | e0/0 (к R12)            | 10.14.12.1/30     |
|            |                 | e0/1 (к R13)            | 10.14.13.1/30     |
|            |                 | e0/1 (к R22 Киторн)     | 38.156.254.14/24  |
|            |                 | e0/3 (к R19)            | 10.14.19.1/30     |
|            |                 | Loopback0               | 192.168.77.14/32  |
| R15        | Москва          | e0/0 (к R13)            | 10.15.13.1/30     |
|            |                 | e0/1 (к R12)            | 10.15.12.1/30     |
|            |                 | e0/2 (к R21 Ламас)      | 131.72.76.15/24   |
|            |                 | e0/3 (к R20)            | 10.15.20.1/30     |
|            |                 | Loopback0               | 192.168.77.15/32  |
| R16        | Санкт-Петербург | e0/0 (к SW10)           |                   |
|            |                 | e0/0.80 (VLAN 80)       | 10.16.108.254/24  |
|            |                 | e0/0.110 (VLAN 110)     | 10.16.101.254/24  |
|            |                 | e0/1 (к R18)            | 10.18.16.2/30     | 
|            |                 | e0/2 (к SW9)            |                   |
|            |                 | e0/2.80 (VLAN 80)       | 10.16.98.254/24   |
|            |                 | e0/2.110 (VLAN 110)     | 10.16.91.254/24   |
|            |                 | e0/3 (к R32)            | 10.16.32.1/30     |
|            |                 | Loopback0               | 192.168.78.16/32  |
| R17        | Санкт-Петербург | e0/0 (к SW9)            |                   |
|            |                 | e0/0.80 (VLAN 80)       | 10.17.98.254/24   |
|            |                 | e0/0.110 (VLAN 110)     | 10.17.91.254/24   |
|            |                 | e0/1 (к R18)            | 10.18.17.2/30     |
|            |                 | e0/2 (к SW10)           |                   |
|            |                 | e0/2.80 (VLAN 80)       | 10.17.108.254/24  |
|            |                 | e0/2.110 (VLAN 110)     | 10.17.101.254/24  |
|            |                 | Loopback0               | 192.168.78.17/32  |
| R16-R17    | Санкт-Петербург | VLAN80                  | 192.168.78.80/24  |
|            |                 | VLAN110                 | 192.168.78.110/24 |
| R18        | Санкт-Петербург | e0/0 (к R16)            | 10.18.16.1/30     |
|            |                 | e0/1 (к R17)            | 10.18.17.1/30     |
|            |                 | e0/2 (к R24 Триада)     | 89.178.182.24/24  |
|            |                 | e0/3 (к R26 Триада)     | 89.178.183.26/24  |
|            |                 | Loopback0               | 192.168.78.18/32  |
| R19        | Москва          | e0/0 (к R14)            | 10.14.19.2/30     |
|            |                 | Loopback0               | 192.168.77.19/32  |
| R20        | Москва          | e0/0 (к R15)            | 10.15.20.2/30     |
|            |                 | Loopback0               | 192.168.77.20/32  |
| R21        | Ламас           | e0/0 (к R15)            | 131.72.76.1/24    |
|            |                 | e0/1 (к R22 Киторн)     | 161.18.208.21/24  |
|            |                 | e0/2 (к R24 Триада)     | 89.178.21.24/24   | 
| R22        | Киторн          | e0/0 (к R14)            | 38.156.254.1/24   |
|            |                 | e0/1 (к R21 Ламас)      | 161.18.208.22/24  |
|            |                 | e0/2 (к R23 Триада)     | 89.178.22.23/24   |
| R23        | Триада          | e0/0 (к R22 Киторн)     | 89.178.22.254/24  |
|            |                 | e0/1 (к R25)            | 172.16.35.25/24   |
|            |                 | e0/2 (к R24)            | 172.16.34.24/24   |
| R24        | Триада          | e0/0 (к R21 Ламас)      | 89.178.21.254/24  |
|            |                 | e0/1 (к R26)            | 172.16.46.26/24   |
|            |                 | e0/2 (к R23)            | 172.16.34.23/24   |
|            |                 | e0/3 (к R18 Питер)      | 89.178.182.254/24 |
| R25        | Триада          | e0/0 (к R23)            | 172.16.35.23/24   |
|            |                 | e0/1 (к R27 Лабытнанги) | 89.178.27.254/24  |
|            |                 | e0/2 (к R25)            | 172.16.56.26/24   |
|            |                 | e0/3 (к R28 Чокурдах)   | 89.178.218.254/24 |
| R26        | Триада          | e0/0 (к R24)            | 172.16.46.24/24   |
|            |                 | e0/1 (к R28 Чокурдах)   | 89.178.208.254/24 |
|            |                 | e0/2 (к R25)            | 172.16.56.25/24   |
|            |                 | e0/3 (к R18 Питер)      | 89.178.183.254/24 |
| R27        | Лабытнанги      | e0/0 (к R25 Триада)     | 89.178.27.25/24   |
|            |                 | Loopback0               | 192.168.89.27/32  |
| R28        | Чокурдах        | e0/0 (к R26 Триада)     | 89.178.208.26/24  |
|            |                 | e0/1 (к R25 Триада)     | 89.178.218.25/24  |
|            |                 | Loopback0               | 192.168.14.28/32  |
| SW29       | Чокурдах        | SVI 14                  | 192.168.14.29/24  |
| VPC30      | Чокурдах        | eth0 (к SW29)           | 192.168.14.30/24  |
| VPC31      | Чокурдах        | eth0 (к SW29)           | 192.168.14.31/24  |
| R32        | Санкт-Петербург | e0/0 (к R16)            | 10.16.32.2/30     |
|            |                 | Loopback0               | 192.168.78.32/32  |


## Шаг 2: Настройка IP-адресов на активных портах

Теперь, пользуясь составленной на предыдущем шаге таблицей, мы можем настроить адреса на устройствах сети.

![step2a](./images/step2a.png)

![step2b](./images/step2b.png)

Пробуем пинговать соседей "снизу" на `R14` и `R15`:

![step2c](./images/step2c.png)

Пингуем `R18` и `R32` с `R16`:

![step2d](./images/step2d.png)

Пингуем с `R24` всех его соседей:

![step2e](./images/step2e.png)

Пингуем с `R25` всех его соседей:

![step2f](./images/step2f.png)

## Шаг 3: Настройка VLAN и SVI-интерфейсов коммутаторов


## Шаг 4: Настройка агрегации каналов (LACP) между коммутаторами

## Шаг 5: Настройка корневых коммутаторов для STP

Чтобы избежать блокировки линков, назначим для каждого VLAN-а свой корневой коммутатор.

## Шаг 6: Настройка VRRP на парах R12-R13 и R16-R17

## Шаг 7: Настройка IP адресов и адресов шлюза по умолчанию на VPC